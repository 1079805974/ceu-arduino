#include "i2c.ceu"
#include "wclock.ceu"

emit I2C(on, _);
_Serial.begin(9600);

par do
    loop do
        var[20] byte str = [];
        await I2C_Read(&str, 8, 4);
        var u8 i;
        loop i in [1-> $str as u8] do
            _Serial.println(rx_buf[i-1]);
            _Serial.flush();
        end
        await 1s;
    end
with
    loop do
        var[5] byte buf = [0,1,2,3,4];
        await I2C_Write(&buf, 8);
        await 1s;
    end
end